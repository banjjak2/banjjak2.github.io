<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Coroutine" /><meta property="og:locale" content="en" /><meta name="description" content="최종 작성 날짜 : 2022-05-05 21:10:35 +0900" /><meta property="og:description" content="최종 작성 날짜 : 2022-05-05 21:10:35 +0900" /><link rel="canonical" href="https://banjjak2.github.io//posts/Coroutine/" /><meta property="og:url" content="https://banjjak2.github.io//posts/Coroutine/" /><meta property="og:site_name" content="개발자로 살아남기" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-05T14:27:05+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Coroutine" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"최종 작성 날짜 : 2022-05-05 21:10:35 +0900","url":"https://banjjak2.github.io//posts/Coroutine/","@type":"BlogPosting","headline":"Coroutine","dateModified":"2022-05-05T14:27:05+09:00","datePublished":"2022-05-05T14:27:05+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://banjjak2.github.io//posts/Coroutine/"},"@context":"https://schema.org"}</script><title>Coroutine | 개발자로 살아남기</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="개발자로 살아남기"><meta name="application-name" content="개발자로 살아남기"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">개발자로 살아남기</a></div><div class="site-subtitle font-italic">공부하자!!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/banjjak2" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['interr0bang','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Coroutine</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Coroutine</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Seongwook Jang </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, May 5, 2022, 2:27 PM +0900" >May 5<i class="unloaded">2022-05-05T14:27:05+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3250 words">18 min read</span></div></div><div class="post-content"><p>최종 작성 날짜 : 2022-05-05 21:10:35 +0900</p><h1 id="coroutine">Coroutine</h1><h2 id="코루틴이란">코루틴이란?</h2><p><code class="language-plaintext highlighter-rouge">코루틴(Coroutine)</code> 자체는 코틀린에 국한된 개념이 아닌 예전부터 알려진 개념이다. 코루틴의 이름은 <code class="language-plaintext highlighter-rouge">Co</code> + <code class="language-plaintext highlighter-rouge">Routine</code>이 합쳐져 불리는 것으로, <code class="language-plaintext highlighter-rouge">Co</code>는 together의 의미를 가지고 있으며 <code class="language-plaintext highlighter-rouge">Routine</code>은 함수라고 생각하면 된다. 즉, 코루틴은 routine들이 서로 상호작용하면서 실행되고, 실행을 <code class="language-plaintext highlighter-rouge">일시정지(suspend)</code>하고 다시 <code class="language-plaintext highlighter-rouge">진행(resume)</code>할 수 있는 <code class="language-plaintext highlighter-rouge">비선점형 멀티태스킹</code>을 위한 <code class="language-plaintext highlighter-rouge">서브루틴(subroutine)</code>을 의미한다.</p><blockquote><h3 id="비선점형-멀티태스킹">비선점형 멀티태스킹<br /></h3><p>CPU를 사용하고 있는 스레드가 작업을 다 완료해야지만 운영체제에서 해당 자원을 회수할 수 있는 것을 의미한다.</p></blockquote><hr /><h3 id="코루틴의-목적">코루틴의 목적</h3><p>코루틴의 목적은 간단하다.</p><ol><li>메인 스레드를 차단하기에는 너무 오래 걸리는 작업을 대신 처리하기 위함이다.<li>일반적인 함수에 suspend 키워드와 withContext를 이용해 코루틴의 실행을 다른 스레드로 쉽게 옮길 수 있다.</ol><p>suspend 키워드를 입력함으로써 코루틴 내에서만 해당 함수를 호출하도록 강제할 수 있다.</p><hr /><h3 id="구조적-동시성-structured-concurrency">구조적 동시성 (Structured concurrency)</h3><p>코루틴은 <code class="language-plaintext highlighter-rouge">구조적 동시성</code>의 원칙을 따른다. 하나의 부모 Scope안에 자식 Scope를 생성할 수 있는데, 자식 Scope에 있는 코드가 모두 실행이 완료(취소도 포함됨)되어야만 부모 Scope가 완료된다는 것이다. 이렇게 구조적 동시성을 지킨 잘 짜여진 코드는 관련된 모든 자식 코루틴이 취소되므로 작업 누수(Work leak)가 발생하지 않는다는 것이다. 작업 누수라는 것은 메모리 누수와 비슷하지만, 코루틴 자체를 잃어버리게 됨으로써 메모리 뿐만 아니라 CPU, Disk 등에도 누수가 발생하는 것을 의미한다.</p><hr /><h3 id="코루틴과-스레드의-차이">코루틴과 스레드의 차이</h3><p>코루틴은 다른 코드들과 동시에 실행된다는 점(비동기)에서 스레드랑 개념적으로는 비슷하지만 엄연히 다르다. <br /> 스레드는 운영체제에서 관리(선점형)하지만 코루틴은 프로그램 코드에서 관리한다. 또한, 스레드에서 작성된 코드는 해당 스레드에서만 실행이 가능하지만, 코루틴은 작성된 코드가 다른 스레드에서 실행이 가능하다.<br /></p><ul><li><p>Thread 사용 시</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlin.concurrent.thread</span>

  <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
      <span class="nf">runThreads</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="k">fun</span> <span class="nf">runThreads</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
          <span class="nf">thread</span> <span class="p">{</span>
              <span class="nf">log</span><span class="p">(</span><span class="s">"$i 번째 스레드"</span><span class="p">)</span>
              <span class="nc">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
              <span class="nf">log</span><span class="p">(</span><span class="s">"$i 번째 스레드 종료"</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  [Thread-3] 3 번째 스레드
  [Thread-4] 4 번째 스레드
  [Thread-2] 2 번째 스레드
  [Thread-1] 1 번째 스레드
  [Thread-5] 5 번째 스레드
  [Thread-1] 1 번째 스레드 종료
  [Thread-3] 3 번째 스레드 종료
  [Thread-2] 2 번째 스레드 종료
  [Thread-5] 5 번째 스레드 종료
  [Thread-4] 4 번째 스레드 종료
</pre></table></code></div></div><p>위 결과에서 스레드 시작과 종료가 동일한 스레드에서 발생하는 것을 볼 수 있다.</p><li><p>Coroutine 사용 시</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlinx.coroutines.*</span>

  <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
      <span class="nf">runCoroutine</span><span class="p">()</span>
      <span class="nf">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">runCoroutine</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
          <span class="nc">CoroutineScope</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">).</span><span class="nf">launch</span> <span class="p">{</span>
              <span class="nf">log</span><span class="p">(</span><span class="s">"$i 번째 코루틴"</span><span class="p">)</span>
              <span class="nf">delay</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
              <span class="nf">log</span><span class="p">(</span><span class="s">"$i 번째 코루틴 종료"</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>  [DefaultDispatcher-worker-1] 1 번째 코루틴
  [DefaultDispatcher-worker-2] 2 번째 코루틴
  [DefaultDispatcher-worker-3] 3 번째 코루틴
  [DefaultDispatcher-worker-3] 4 번째 코루틴
  [DefaultDispatcher-worker-3] 5 번째 코루틴
  [DefaultDispatcher-worker-1] 2 번째 코루틴 종료
  [DefaultDispatcher-worker-3] 1 번째 코루틴 종료
  [DefaultDispatcher-worker-3] 3 번째 코루틴 종료
  [DefaultDispatcher-worker-3] 4 번째 코루틴 종료
  [DefaultDispatcher-worker-3] 5 번째 코루틴 종료
</pre></table></code></div></div><p>위 결과를 보면 시작과 종료가 다른 스레드에서 발생한 것을 볼 수 있다.</p></ul><hr /><h3 id="코루틴의-장점">코루틴의 장점</h3><p>코루틴을 사용하면 여러가지 이점이 있는데, 네트워크 통신을 예로들면 스레드는 통신이 완료됐을 때 결괏값을 콜백함수를 통해 전달해야한다. 하지만, 코루틴은 일시정지가 가능하므로 통신이 완료됐을 때 일반함수처럼 결괏값을 반환받아 다음 코드로 전달해 실행할 수 있다. 스레드에서 UI를 업데이트할 수 없으므로 <code class="language-plaintext highlighter-rouge">invokeLater</code>를 이용해 업데이트를 다른 스레드에서 할 수 있도록 했다. 아래 예시를 참고하자.</p><ul><li><p>Thread 사용 시</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlinx.coroutines.runBlocking</span>
  <span class="k">import</span> <span class="nn">javax.swing.SwingUtilities</span>
  <span class="k">import</span> <span class="nn">kotlin.concurrent.thread</span>

  <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

  <span class="k">fun</span> <span class="nf">loadImageThread</span><span class="p">(</span><span class="n">updateUI</span><span class="p">:</span> <span class="p">(</span><span class="nc">String</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Unit</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">thread</span> <span class="p">{</span>
          <span class="nf">log</span><span class="p">(</span><span class="s">"네트워크 통신중"</span><span class="p">)</span>
          <span class="nc">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span> <span class="c1">// 네트워크 통신 가정</span>
          <span class="nf">updateUI</span><span class="p">(</span><span class="s">"이미지를 가져왔습니다."</span><span class="p">)</span> <span class="c1">// UI 업데이트</span>
      <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
      <span class="nf">loadImageThread</span> <span class="p">{</span> <span class="c1">// 콜백함수 등록</span>
          <span class="nc">SwingUtilities</span><span class="p">.</span><span class="nf">invokeLater</span> <span class="p">{</span>
              <span class="nf">updateUI</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
      <span class="nf">log</span><span class="p">(</span><span class="s">"main은 계속 실행됨"</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">fun</span> <span class="nf">updateUI</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  [main] main은 계속 실행됨
  [Thread-1] 네트워크 통신중
  [AWT-EventQueue-0] 이미지를 가져왔습니다.
</pre></table></code></div></div><li><p>Coroutine 사용 시</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlinx.coroutines.*</span>

  <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

  <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">loadImageCoroutine</span><span class="p">():</span> <span class="nc">String</span> <span class="p">{</span>
      <span class="nf">withContext</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span> <span class="p">{</span>
          <span class="nf">log</span><span class="p">(</span><span class="s">"네트워크 통신중"</span><span class="p">)</span>
          <span class="nf">delay</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span> <span class="c1">// 네트워크 통신 가정</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="s">"이미지를 불러왔습니다."</span>
  <span class="p">}</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
      <span class="nf">launch</span> <span class="p">{</span>
          <span class="kd">val</span> <span class="py">message</span> <span class="p">=</span> <span class="nf">loadImageCoroutine</span><span class="p">()</span>
          <span class="nf">updateUI</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="nf">log</span><span class="p">(</span><span class="s">"main은 계속 실행됨"</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">fun</span> <span class="nf">updateUI</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  [main] main은 계속 실행됨
  [DefaultDispatcher-worker-1] 네트워크 통신중
  [main] 이미지를 불러왔습니다.
</pre></table></code></div></div></ul><hr /><h2 id="코루틴-관련-변수들-정리">코루틴 관련 변수들 정리</h2><h3 id="1-coroutinescope-vs-coroutinescope">1. <code class="language-plaintext highlighter-rouge">CoroutineScope</code> vs <code class="language-plaintext highlighter-rouge">coroutineScope</code></h3><p><code class="language-plaintext highlighter-rouge">CoroutineScope</code>과 <code class="language-plaintext highlighter-rouge">coroutineScope</code>은 <code class="language-plaintext highlighter-rouge">C(대문자)</code>와 <code class="language-plaintext highlighter-rouge">c(소문자)</code>의 한글자 차이지만 그 차이는 크다. 먼저 코드를 살펴보고 차이를 확인해보자.</p><ul><li><p>CoroutineScope</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlinx.coroutines.*</span>

  <span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>
      <span class="nc">CoroutineScope</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">).</span><span class="nf">launch</span> <span class="p">{</span>
          <span class="n">count</span> <span class="p">=</span> <span class="nf">createNewCoroutine</span><span class="p">()</span>
          <span class="nf">log</span><span class="p">(</span><span class="s">"result : $count"</span><span class="p">)</span>
      <span class="p">}.</span><span class="nf">join</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">createNewCoroutine</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>
      <span class="nc">CoroutineScope</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">).</span><span class="nf">launch</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">count</span><span class="p">++</span>
              <span class="nf">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">count</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  [DefaultDispatcher-worker-1] result : 0
</pre></table></code></div></div><li><p>coroutineScope</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="nn">kotlinx.coroutines.*</span>

  <span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>
      <span class="nc">CoroutineScope</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">Default</span><span class="p">).</span><span class="nf">launch</span> <span class="p">{</span>
          <span class="n">count</span> <span class="p">=</span> <span class="nf">createNewCoroutine</span><span class="p">()</span>
          <span class="nf">log</span><span class="p">(</span><span class="s">"result : $count"</span><span class="p">)</span>
      <span class="p">}.</span><span class="nf">join</span><span class="p">()</span>
  <span class="p">}</span>

  <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">createNewCoroutine</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="py">count</span> <span class="p">=</span> <span class="mi">0</span>
      <span class="nf">coroutineScope</span> <span class="p">{</span>
          <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">count</span><span class="p">++</span>
              <span class="nf">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">count</span>
  <span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  [DefaultDispatcher-worker-1] result : 20
</pre></table></code></div></div></ul><p>위 코드에서 우리가 예상한 결괏값은 <code class="language-plaintext highlighter-rouge">20</code>이지만, 두 개의 결과는 다른것을 확인할 수 있다. <code class="language-plaintext highlighter-rouge">CoroutineScope</code>과 <code class="language-plaintext highlighter-rouge">coroutineScope</code>에 대한 설명은 아래와 같다.</p><ul><li>CoroutineScope<ol><li>완전 새로운 코루틴을 위한 범위(Scope)를 코루틴 빌더(<code class="language-plaintext highlighter-rouge">launch</code>, <code class="language-plaintext highlighter-rouge">async</code>)와 <code class="language-plaintext highlighter-rouge">Dispatcher</code>를 이용해 정의할 수 있다.<li><code class="language-plaintext highlighter-rouge">coroutineContext</code>를 새로 생성해서 범위 안에 있는 다른 코루틴들을 모두 취소할 수도 있다.<li><code class="language-plaintext highlighter-rouge">CoroutineScope</code>를 이용해 코루틴을 생성하면 <code class="language-plaintext highlighter-rouge">StandaloneCoroutine</code>객체가 생성된다.<ul><li>정확히는 코루틴 빌더 (launch)에 의해 새로운 코루틴이 생성되는 것이다.</ul><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/29175138/166895989-e900ec7c-156f-4a88-9149-473dcb231d9c.png" alt="image" /></p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/29175138/166898107-81c4a1f1-143e-4950-be1c-11d485a27a95.png" alt="image" /></p></ol><li>coroutineScope<ol><li>범위(Scope)내에서 또다른 범위(Scope)를 실행하기 위해 사용하는 <code class="language-plaintext highlighter-rouge">Scope Builder</code>이다.<li>부모 Scope에 있는 <code class="language-plaintext highlighter-rouge">coroutineContext</code>를 상속받아 <code class="language-plaintext highlighter-rouge">coroutineContext</code>의 <code class="language-plaintext highlighter-rouge">job</code>을 재정의하며 이 scope안에 있는 다른 코루틴들을 모두 취소할 수도 있다.<li><p><code class="language-plaintext highlighter-rouge">coroutineScope</code>를 이용해 코루틴을 생성하면 <code class="language-plaintext highlighter-rouge">ScopeCoroutine</code>객체가 생성된다.</p><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/29175138/166896909-c3940f4b-42ae-40fd-921b-5d7954354997.png" alt="image" /></p></ol></ul><p><code class="language-plaintext highlighter-rouge">CoroutineScope</code>은 부모 코루틴 범위에 있더라도 부모 코루틴과 상관없는 아예 새로운 코루틴을 생성하기 때문에 일시정지가 되지 않고 바로 값을 반환해서 결괏값이 0이 출력되었으며, <code class="language-plaintext highlighter-rouge">coroutineScope</code>은 부모 코루틴의 범위 내에 있으므로 일시정지되어 작업을 수행한 후에 값을 반환하게 되므로 20이 출력되었다.</p><h3 id="2-coroutinecontext">2. coroutineContext</h3><p><code class="language-plaintext highlighter-rouge">coroutineContext</code>는 코루틴 빌더를 이용해 생성될 때 같이 생성되는 <code class="language-plaintext highlighter-rouge">context</code>이다. 이 <code class="language-plaintext highlighter-rouge">coroutineContext</code>를 이용해 자식 코루틴들을 관리할 수 있다. 위에서 언급한 것처럼 <code class="language-plaintext highlighter-rouge">coroutineScope</code>를 이용해 자식 코루틴을 만들게 되면 자식 코루틴은 부모 코루틴의 <code class="language-plaintext highlighter-rouge">coroutineContext</code>를 상속받아 사용한다. 일반적으로 이 <code class="language-plaintext highlighter-rouge">context</code>에 특별한 목적을 제외하고는 직접 접근하는 것을 추천하지 않는다.</p><h3 id="3-scope-builder">3. Scope builder</h3><p><code class="language-plaintext highlighter-rouge">coroutineScope</code> 또는 <code class="language-plaintext highlighter-rouge">runBlocking</code>을 이용해 자신만의 scope을 지정할 수 있으며 scope 내부에 있는 자식 코루틴들이 끝날때까지 완료되지 않는다. <br /> <code class="language-plaintext highlighter-rouge">coroutineScope</code>과 <code class="language-plaintext highlighter-rouge">runBlocking</code>이 둘 다 Scope builder이지만 둘의 차이점은 명확하다. <code class="language-plaintext highlighter-rouge">coroutineScope</code>은 현재 실행중인 스레드를 차단하지 않고 코루틴을 실행하지만, <code class="language-plaintext highlighter-rouge">runBlocking</code>은 현재 실행중인 스레드를 차단한 후 자식 코루틴들이 다 완료될 때까지 기다리고, 모두 완료가 되면 차단된 스레드를 다시 실행한다. <br /> 콘솔로 코루틴을 테스트할 때 <code class="language-plaintext highlighter-rouge">main</code>함수에 <code class="language-plaintext highlighter-rouge">runBlocking</code>을 설정하는 이유는 메인 스레드를 차단하지 않게 되면 코루틴이 실행되어도 프로그램이 종료되어 코루틴을 테스트할 수 없게 된다.<br /> 또한, Scope builder안에 코루틴 빌더를 사용하여 부모가 있는 여러개의 코루틴을 생성할 수 있다.</p><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">time</span> <span class="p">=</span> <span class="nf">measureTimeMillis</span> <span class="p">{</span>
        <span class="nf">doSomething</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"main end [$time ms]"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">doSomething</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">coroutineScope</span> <span class="p">{</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"launch 2"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"launch 1"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">println</span><span class="p">(</span><span class="s">"coroutineScope"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>coroutineScope
launch 1
launch 2
main end [2035 ms]
</pre></table></code></div></div><h3 id="4-coroutine-builder">4. Coroutine builder</h3><p>코루틴 빌더를 이용해 새로운 코루틴을 생성할 수 있으며, 코루틴 빌더에는 <code class="language-plaintext highlighter-rouge">launch</code>와 <code class="language-plaintext highlighter-rouge">async</code> 등이 있다. 이 코루틴 빌더를 이용해 새로운 코루틴을 생성할 수 있으며 독립적으로 작동한다. <br /> <code class="language-plaintext highlighter-rouge">3. Scope builder</code>의 예시를 보면 알 수 있듯이, <code class="language-plaintext highlighter-rouge">launch</code>코루틴 빌더를 이용해 독립적으로 코루틴을 시작하고, <code class="language-plaintext highlighter-rouge">coroutineScope</code>에서는 자식 코루틴들이 모두 종료될 때까지 기다리게 되므로 처음 <code class="language-plaintext highlighter-rouge">coroutineScope</code>을 출력한 후 1초후에 <code class="language-plaintext highlighter-rouge">launch 1</code>이 출력되고, 다시 또 1초후에 <code class="language-plaintext highlighter-rouge">launch 2</code>가 호출된다. 그리고 모든 자식 코루틴이 종료됐으므로 <code class="language-plaintext highlighter-rouge">coroutineScope</code>이 종료된 후 메인 함수로 돌아가 <code class="language-plaintext highlighter-rouge">main end</code>를 호출하게 된다.<br /> <code class="language-plaintext highlighter-rouge">launch</code>와 <code class="language-plaintext highlighter-rouge">async</code>의 차이점은 반환값에 있다. <code class="language-plaintext highlighter-rouge">launch</code>는 <code class="language-plaintext highlighter-rouge">Job</code>이라는 객체로 반환을 하지만, <code class="language-plaintext highlighter-rouge">async</code>는 함수를 실행한 결괏값을 반환받을 수 있다. 즉, 함수 실행시 반환값을 받아야하는 경우 <code class="language-plaintext highlighter-rouge">async</code>로 코루틴을 생성하고 <code class="language-plaintext highlighter-rouge">await</code> 메소드로 결괏값을 받을 때까지 일시정지 상태를 유지한다.</p><h3 id="5-dispatchers">5. Dispatchers</h3><p>코루틴이 실행되는 위치를 지정할 수 있으며, <code class="language-plaintext highlighter-rouge">Main</code>, <code class="language-plaintext highlighter-rouge">IO</code>, <code class="language-plaintext highlighter-rouge">Default</code>가 존재한다. 기본적으로 안드로이드에서는 기본적으로 코루틴을 생성할 때 <code class="language-plaintext highlighter-rouge">Dispatchers.Main</code>을 사용하고 실행 위치를 변경해야할 때 <code class="language-plaintext highlighter-rouge">withContext</code>를 이용해 실행 위치를 변경한다. 각각 언제 사용해야되는지에 대해 살펴보면 아래와 같다.</p><ol><li>Dispatchers.Main<ul><li>UI와 상호작용해야할 때<li>suspend 함수를 호출할 때<li>UI 관련 함수를 호출할 때<li>LiveData를 업데이트할 때</ul><li>Dispatchers.IO<ul><li>디스크 또는 네트워크 IO를 처리할 때<li>데이터베이스<li>파일 입/출력<li>네트워크</ul><li>Dispatchers.Default<ul><li>CPU를 많이 사용하는 작업을 처리할 때<li>List 정렬<li>JSON 파싱<li>DiffUtils</ul></ol><p><strong>코드</strong></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span text-data=" Kotlin "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">kotlinx.coroutines.*</span>
<span class="k">import</span> <span class="nn">kotlin.system.measureTimeMillis</span>

<span class="k">fun</span> <span class="nf">log</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">=</span> <span class="nf">println</span><span class="p">(</span><span class="s">"[${Thread.currentThread().name}] $message"</span><span class="p">)</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">=</span> <span class="nf">runBlocking</span> <span class="p">{</span>
    <span class="nf">log</span><span class="p">(</span><span class="s">"main start"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">time</span> <span class="p">=</span> <span class="nf">measureTimeMillis</span> <span class="p">{</span>
        <span class="nf">doSomething</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="nf">log</span><span class="p">(</span><span class="s">"main end [$time ms]"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">suspend</span> <span class="k">fun</span> <span class="nf">doSomething</span><span class="p">()</span> <span class="p">{</span>
    <span class="nf">withContext</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
            <span class="nf">log</span><span class="p">(</span><span class="s">"launch 2"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">launch</span> <span class="p">{</span>
            <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
            <span class="nf">log</span><span class="p">(</span><span class="s">"launch 1"</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">log</span><span class="p">(</span><span class="s">"coroutineScope"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>결과</strong></p><div class="language-text highlighter-rouge"><div class="code-header"> <span text-data=" Text "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[main] main start
[DefaultDispatcher-worker-1] coroutineScope
[DefaultDispatcher-worker-3] launch 1
[DefaultDispatcher-worker-3] launch 2
[main] main end [2088 ms]
</pre></table></code></div></div><hr /><h3 id="출처">[출처]</h3><ul><li>https://en.wikipedia.org/wiki/Coroutine<li>https://kotlinlang.org/docs/coroutines-basics.html<li>https://play.kotlinlang.org/hands-on/Introduction%20to%20Coroutines%20and%20Channels/01_Introduction<li>https://medium.com/androiddevelopers/coroutines-on-android-part-i-getting-the-background-3e0e54d20bb<li>https://medium.com/androiddevelopers/coroutines-on-android-part-ii-getting-started-3bff117176dd</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kotlin/'>Kotlin</a>, <a href='/categories/coroutine/'>Coroutine</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kotlin/" class="post-tag no-text-decoration" >Kotlin</a> <a href="/tags/coroutine/" class="post-tag no-text-decoration" >Coroutine</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Coroutine - 개발자로 살아남기&url=https://banjjak2.github.io//posts/Coroutine/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Coroutine - 개발자로 살아남기&u=https://banjjak2.github.io//posts/Coroutine/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Coroutine - 개발자로 살아남기&url=https://banjjak2.github.io//posts/Coroutine/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/7576-%ED%86%A0%EB%A7%88%ED%86%A0/">[BOJ 7576] 토마토</a><li><a href="/posts/2178-%EB%AF%B8%EB%A1%9C-%ED%83%90%EC%83%89/">[BOJ 2178] 미로 탐색</a><li><a href="/posts/Generics/">Generics</a><li><a href="/posts/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4/">디자인 패턴</a><li><a href="/posts/%EB%B0%B1%EC%A4%80-%EB%AC%B8%EC%A0%9C%ED%92%80%EC%9D%B4-%EB%AA%A9%EB%A1%9D/">백준(BOJ) 문제풀이 목록</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/boj/">BOJ</a> <a class="post-tag" href="/tags/%EB%B0%B1%EC%A4%80/">백준</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/coroutine/">Coroutine</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/cs/">CS</a> <a class="post-tag" href="/tags/%EB%AC%B8%EC%A0%9C%ED%95%B4%EA%B2%B0/">문제해결</a> <a class="post-tag" href="/tags/10026/">10026</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Coroutine-%EC%9B%90%EB%A6%AC/"><div class="card-body"> <span class="timeago small" >May 6<i class="unloaded">2022-05-06T15:18:24+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Coroutine 원리</h3><div class="text-muted small"><p> 최종 수정 날짜 : 2022-05-06 16:58:38 +0900 Coroutine 원리 코루틴이 어떻게 작동되는가에 대해 공부한 내용을 정리해보았다. 이전 글을 참고해보면, 코루틴은 처음 생성될 때 사용한 스레드가 아닌 다른 스레드에서도 실행될 수 있다고 했다. 그게 가능한 이유는 아래 gif를 참고해보자. 스레드에서 코루틴이 suspen...</p></div></div></a></div><div class="card"> <a href="/posts/Coroutine-%EC%B7%A8%EC%86%8C-%EB%B0%8F-%EC%98%88%EC%99%B8%EC%B2%98%EB%A6%AC/"><div class="card-body"> <span class="timeago small" >May 8<i class="unloaded">2022-05-08T16:37:28+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Coroutine 취소 및 예외처리</h3><div class="text-muted small"><p> 일반적인 코루틴 예외처리 방법 (CoroutineExceptionHandler) 코루틴에서 예외를 처리하는 일반적인 방법은 CoroutineScope을 이용해 새 코루틴을 생성할 때 CoroutineExceptionHandler를 이용해 예외를 처리할 수 있다. 코드 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 1...</p></div></div></a></div><div class="card"> <a href="/posts/Coroutine%EC%97%90%EC%84%9C-Retrofit-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EC%95%8C%EC%95%84%EB%91%98-%EC%A0%90/"><div class="card-body"> <span class="timeago small" >May 7<i class="unloaded">2022-05-07T17:18:13+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Coroutine에서 Retrofit 사용 시 알아둘 점</h3><div class="text-muted small"><p> 이전에 안드로이드 앱을 구현하면서 Coroutine에서 Retrofit을 사용한 적이 있었다. 그때 당시에는 인터넷 예제에서는 대부분 아래와 같이 구현되어 있었다. 1 2 3 4 interface XXXService { @GET("api/YYYY") suspend fun getData(): Call&lt;ZZZZ&gt; // 또는 Re...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-Job/" class="btn btn-outline-primary" prompt="Older"><p>코루틴 Job</p></a> <a href="/posts/Coroutine-%EC%9B%90%EB%A6%AC/" class="btn btn-outline-primary" prompt="Newer"><p>Coroutine 원리</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://banjjak2.github.io//posts/Coroutine/'; this.page.identifier = '/posts/Coroutine/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://https-banjjak2-github-io.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/banjjak2">Seongwook Jang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/boj/">BOJ</a> <a class="post-tag" href="/tags/%EB%B0%B1%EC%A4%80/">백준</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/coroutine/">Coroutine</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/cs/">CS</a> <a class="post-tag" href="/tags/%EB%AC%B8%EC%A0%9C%ED%95%B4%EA%B2%B0/">문제해결</a> <a class="post-tag" href="/tags/10026/">10026</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
